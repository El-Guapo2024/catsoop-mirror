TODOs:

* write the queue stuff for the fs backend

* is this too ugly as-is?  passing around the connection is a pain

* load testing?
